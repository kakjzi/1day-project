# Admin Frontend Business Rules

## 1. 인증 규칙

### BR-AUTH-01: 로그인 검증
- 매장 ID: 필수, 숫자
- 사용자명: 필수, 최소 3자
- 비밀번호: 필수, 최소 6자

### BR-AUTH-02: 세션 만료
- JWT 토큰 유효 기간: 16시간
- 만료 시 자동 로그아웃
- 만료 전 API 호출 시 401 응답 → 로그인 페이지 리다이렉트

### BR-AUTH-03: 관리자 등록
- 사용자명 중복 불가
- 비밀번호 확인 일치 필수
- 등록 후 별도 승인 없이 즉시 사용 가능

### BR-AUTH-04: 토큰 저장
- localStorage에 저장
- 키: `admin_token`
- 로그아웃 시 삭제

---

## 2. 주문 상태 규칙

### BR-ORDER-01: 상태 전이
```
허용된 전이:
PENDING → ACCEPTED
ACCEPTED → PREPARING
PREPARING → COMPLETED

금지된 전이:
- 역방향 전이 불가
- 상태 건너뛰기 불가
- COMPLETED에서 다른 상태로 변경 불가
```

### BR-ORDER-02: 상태별 UI 표시
| 상태 | 한글 | 색상 | 버튼 텍스트 |
|------|------|------|-------------|
| PENDING | 대기중 | 노란색 | 접수 |
| ACCEPTED | 접수 | 파란색 | 준비 시작 |
| PREPARING | 준비중 | 주황색 | 완료 |
| COMPLETED | 완료 | 초록색 | (버튼 없음) |

### BR-ORDER-03: 주문 삭제 규칙
- COMPLETED 상태 주문은 삭제 불가
- 삭제 시 확인 팝업 필수
- 삭제 후 테이블 총액 자동 재계산

### BR-ORDER-04: 신규 주문 알림
- SSE로 NEW_ORDER 이벤트 수신 시
- 브라우저 기본 알림음 재생
- 해당 테이블 카드 3초간 하이라이트

---

## 3. 테이블 관리 규칙

### BR-TABLE-01: 테이블 카드 표시
- 최근 주문 5개만 미리보기 표시
- 클릭 시 전체 주문 목록 모달
- 총 주문액 실시간 표시

### BR-TABLE-02: 이용 완료 규칙
- 확인 팝업 필수
- 현재 세션의 모든 주문 → OrderHistory로 이동
- 테이블 리셋: 주문 목록 비움, 총액 0원
- 세션 ID 초기화

### BR-TABLE-03: 주문 이동 규칙
- 같은 테이블로 이동 불가
- 확인 팝업 필수
- 이동 후:
  - 원본 테이블: 리셋 (총액 0원)
  - 대상 테이블: 주문 추가, 총액 합산

### BR-TABLE-04: 과거 주문 조회
- 기본 날짜: 오늘
- 날짜 선택 필터로 다른 날짜 조회 가능
- 시간 역순 정렬

---

## 4. 메뉴 관리 규칙

### BR-MENU-01: 메뉴 필수 필드
| 필드 | 필수 | 검증 |
|------|:----:|------|
| 메뉴명 | ✓ | 최소 1자, 최대 50자 |
| 가격 | ✓ | 0 이상 정수 |
| 카테고리 | ✓ | 유효한 카테고리 ID |
| 설명 | | 최대 500자 |
| 이미지 | | URL 형식 |

### BR-MENU-02: 메뉴 삭제 규칙
- 확인 팝업 필수
- 삭제 시 연관된 옵션 그룹/옵션도 함께 삭제

### BR-MENU-03: 카테고리 삭제 규칙
- 해당 카테고리에 메뉴가 있으면 삭제 불가
- 또는 메뉴를 다른 카테고리로 이동 후 삭제

---

## 5. 이미지 업로드 규칙

### BR-IMAGE-01: 파일 제한
- 최대 크기: 1MB
- 허용 형식: JPEG, PNG, GIF, WebP
- MIME 타입 검증 필수

### BR-IMAGE-02: 미리보기
- 파일 선택 즉시 미리보기 표시
- 업로드 전 미리보기 필수
- 미리보기 크기: 200x200px (비율 유지)

---

## 6. 옵션 관리 규칙

### BR-OPTION-01: 옵션 그룹
- 그룹명: 필수, 최대 30자
- 필수 여부: boolean
- 최대 선택 수: 1 이상 (기본값 1)

### BR-OPTION-02: 옵션 항목
- 옵션명: 필수, 최대 30자
- 추가 가격: 0 이상 정수

---

## 7. UI/UX 규칙

### BR-UI-01: 반응형 그리드
- 대시보드 테이블 카드: 반응형 그리드
- 최소 1열 (모바일) ~ 최대 4열 (데스크톱)
- MUI Grid 사용

### BR-UI-02: 확인 팝업 필요 작업
| 작업 | 확인 팝업 |
|------|:--------:|
| 주문 상태 변경 | ✗ |
| 주문 삭제 | ✓ |
| 테이블 이용 완료 | ✓ |
| 테이블 주문 이동 | ✓ |
| 메뉴 삭제 | ✓ |
| 카테고리 삭제 | ✓ |

### BR-UI-03: 에러 표시
- API 에러: 토스트 메시지 (3초 후 자동 닫힘)
- 폼 검증 에러: 필드 아래 인라인 메시지
- 네트워크 에러: 재시도 버튼 포함 알림

### BR-UI-04: 로딩 상태
- API 호출 중: 버튼 비활성화 + 스피너
- 페이지 로딩: 스켈레톤 UI
- SSE 연결 중: 연결 상태 표시

---

## 8. 입력 검증 규칙

### BR-VALID-01: 공통 검증
```typescript
// 필수 필드
required: (value) => !!value || '필수 입력 항목입니다'

// 최소 길이
minLength: (min) => (value) => 
  value.length >= min || `최소 ${min}자 이상 입력하세요`

// 최대 길이
maxLength: (max) => (value) => 
  value.length <= max || `최대 ${max}자까지 입력 가능합니다`

// 숫자
number: (value) => !isNaN(value) || '숫자만 입력 가능합니다'

// 양수
positive: (value) => value >= 0 || '0 이상의 값을 입력하세요'
```

### BR-VALID-02: 비밀번호 검증
- 최소 6자
- 비밀번호 확인 일치

### BR-VALID-03: 가격 검증
- 0 이상 정수
- 최대 9,999,999원
